{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// strict mode\n'use strict'\n\nexport function fetchImages(searchCriteria, pageNum) {\n \n    const searchParams = new URLSearchParams({\n        key: \"43557588-360f3c0dbe3221038cf66573a\",\n        q: searchCriteria,\n        page: pageNum,\n        image_type: \"photo\",\n        orientation: \"horizontal\", \n        safesearch: true \n    });\n    \n    const url = `https://pixabay.com/api/?${searchParams}`;\n\n    return fetch(url);\n };","// Import the SimpleLightbox library\nimport SimpleLightbox from \"simplelightbox\";\n// Additional import of SimpleLightbox style\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n// strict mode\n'use strict'\n\nexport function renderImagesByPages(dataHit) { \n    \n    let gallery = document.querySelector(\"ul.gallery-ul\");\n    // Clear gallery content to avoid mixing query results\n    gallery.innerHTML = \"\";\n\n    const markup = dataHit\n            .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n                `    <li class=\"gallery-item\">\n                        <div class=\"gallery\">\n                            <a class=\"gallery-link\" href=\"${largeImageURL}\" >\n                                <img class=\"gallery-image\" src=\"${webformatURL}\" data-source=\"${largeImageURL}\" alt=\"${tags}\" />\n                            </a>\n                        </div>    \n                        <div class=\"gallery-props\">\n                            <div class=\"gallery-props-item\">\n                                Likes\n                                    <div class=\"gallery-props-number\">${likes}</div>\n                            </div>\n                            <div class=\"gallery-props-item\">\n                                Views\n                                    <div class=\"gallery-props-number\">${views}</div>\n                            </div>\n                            <div class=\"gallery-props-item\">\n                                Comments\n                                    <div class=\"gallery-props-number\">${comments}</div>\n                            </div>\n                            <div class=\"gallery-props-item\">\n                                Downloads\n                                    <div class=\"gallery-props-number\">${downloads}</div>\n                            </div>\n                        </div>\n                    </li>`\n            )\n            .join(\"\");\n        \n    gallery.insertAdjacentHTML(\"afterbegin\", markup);\n    \n    gallery = new SimpleLightbox(\".gallery a\", {                   // the simpleLightbox pattern\n        captions: true,                                            // show captions if availabled or not\n        captionSelector: 'img',                                    // set the element where the caption is\n        captionsData: 'alt',                                       // get the caption from given attribute\n        captionPosition: 'bottom',                                        \n        captionDelay: 250,                                         // delay before the caption shows (in ms)\n        captionType: 'attr'                                        // how to get the caption.                                                                  // You can choose between attr, data or text\n    });\n    \n    gallery.refresh();\n\n}","//  Main import of iziToast\nimport iziToast from \"izitoast\";\n// Additional import of iziToast style\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderImagesByPages } from \"./js/render-functions.js\";\n\n// strict mode\n'use strict'\n\nconst searchFld = document.querySelector(\".search-block-field\");\nconst searchBtn = document.querySelector(\".search-block-button\"); \nconst loader = document.querySelector(\".loader\");\nlet gallery = document.querySelector(\"ul.gallery-ul\");\n\nlet searchCriteria = '';\nlet pageNum;\n\nsearchFld.addEventListener(\"input\", () => { \n    searchCriteria = searchFld.value;\n});\n\nsearchBtn.addEventListener(\"click\", () => { \n    // Search field cannot be empty\n    if (searchCriteria.trim()) {\n        gallery.innerHTML = \"\";\n        fetchImages(searchCriteria)\n            .then(response => { \n                // Clear Search field           \n                searchFld.value = '';\n                // Parse the JSON response\n                return response.json();\n            })\n            .then(data => {\n                // Check if the total number of items is 0\n                if (data.total === 0) { \n                    iziToast.error({\n                        title: 'Error',\n                        message: 'Sorry, there are no images matching your search query. Please try again!'\n                    });\n                    \n                    searchCriteria = '';\n                    return;\n                };\n                loader.style.display = 'block';\n                const totalImages = data.total;\n                // Don't know yet how to process a large number of pages (next module),\n                // so I limited the number of pages to 5\n                // const totalPages = Math.ceil(totalImages / 20);\n                const totalPages = 5;\n                const promises = [];\n\n                for (pageNum = 1; pageNum <= totalPages; pageNum++) { \n\n                    promises.push(fetchImages(searchCriteria, pageNum)\n                        .then(response => response.json())\n                        .then(data => {\n                            return data.hits;\n                        }))\n                };\n\n                Promise.all(promises)\n                    .then(results => {\n                        // console.log(\"results.flat\", results.flat());\n                        renderImagesByPages(results.flat());\n                        loader.style.display = 'none';\n                        searchCriteria = '';\n                    })\n                    .catch(error => console.log(error))\n            })\n            .catch(error => console.error(error));\n    } else { \n        iziToast.error({\n            title: 'Error',\n            message: 'Search field cannot be empty'\n        });\n        gallery.innerHTML = \"\";\n        return;\n    }\n});\n\n\n"],"names":["fetchImages","searchCriteria","pageNum","url","renderImagesByPages","dataHit","gallery","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","searchFld","searchBtn","loader","response","data","iziToast","totalPages","promises","results","error"],"mappings":"6vBAGO,SAASA,EAAYC,EAAgBC,EAAS,CAWjD,MAAMC,EAAM,4BATS,IAAI,gBAAgB,CACrC,IAAK,qCACL,EAAGF,EACH,KAAMC,EACN,WAAY,QACZ,YAAa,aACb,WAAY,EACpB,CAAK,CAEmD,GAEpD,OAAO,MAAMC,CAAG,CACpB,CCTO,SAASC,EAAoBC,EAAS,CAEzC,IAAIC,EAAU,SAAS,cAAc,eAAe,EAEpDA,EAAQ,UAAY,GAEpB,MAAMC,EAASF,EACN,IAAI,CAAC,CAAE,aAAAG,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAC1E;AAAA;AAAA,4DAE4CL,CAAa;AAAA,kEACPD,CAAY,kBAAkBC,CAAa,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wEAMnDC,CAAK;AAAA;AAAA;AAAA;AAAA,wEAILC,CAAK;AAAA;AAAA;AAAA;AAAA,wEAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,wEAIRC,CAAS;AAAA;AAAA;AAAA,0BAIpE,EACA,KAAK,EAAE,EAEhBR,EAAQ,mBAAmB,aAAcC,CAAM,EAE/CD,EAAU,IAAIS,EAAe,aAAc,CACvC,SAAU,GACV,gBAAiB,MACjB,aAAc,MACd,gBAAiB,SACjB,aAAc,IACd,YAAa,MACrB,CAAK,EAEDT,EAAQ,QAAO,CAEnB,CC9CA,MAAMU,EAAY,SAAS,cAAc,qBAAqB,EACxDC,EAAY,SAAS,cAAc,sBAAsB,EACzDC,EAAS,SAAS,cAAc,SAAS,EAC/C,IAAIZ,EAAU,SAAS,cAAc,eAAe,EAEhDL,EAAiB,GACjBC,EAEJc,EAAU,iBAAiB,QAAS,IAAM,CACtCf,EAAiBe,EAAU,KAC/B,CAAC,EAEDC,EAAU,iBAAiB,QAAS,IAAM,CAEtC,GAAIhB,EAAe,OACfK,EAAQ,UAAY,GACpBN,EAAYC,CAAc,EACrB,KAAKkB,IAEFH,EAAU,MAAQ,GAEXG,EAAS,OACnB,EACA,KAAKC,GAAQ,CAEV,GAAIA,EAAK,QAAU,EAAG,CAClBC,EAAS,MAAM,CACX,MAAO,QACP,QAAS,0EACjC,CAAqB,EAEDpB,EAAiB,GACjB,MAEpB,CAAgBiB,EAAO,MAAM,QAAU,QACHE,EAAK,MAIzB,MAAME,EAAa,EACbC,EAAW,CAAA,EAEjB,IAAKrB,EAAU,EAAGA,GAAWoB,EAAYpB,IAErCqB,EAAS,KAAKvB,EAAYC,EAAgBC,CAAO,EAC5C,KAAKiB,GAAYA,EAAS,MAAM,EAChC,KAAKC,GACKA,EAAK,IACf,CAAC,EAGV,QAAQ,IAAIG,CAAQ,EACf,KAAKC,GAAW,CAEbpB,EAAoBoB,EAAQ,KAAI,CAAE,EAClCN,EAAO,MAAM,QAAU,OACvBjB,EAAiB,EACzC,CAAqB,EACA,MAAMwB,GAAS,QAAQ,IAAIA,CAAK,CAAC,CACtD,CAAa,EACA,MAAMA,GAAS,QAAQ,MAAMA,CAAK,CAAC,MACrC,CACHJ,EAAS,MAAM,CACX,MAAO,QACP,QAAS,8BACrB,CAAS,EACDf,EAAQ,UAAY,GACpB,MACH,CACL,CAAC"}